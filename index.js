!function(e){var r={};function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)o.d(t,s,function(r){return e[r]}.bind(null,s));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="",o(o.s=6)}([function(e,r){e.exports={secret:"mykhadeemappbynaveenkumard",routePrefix:"/api"}},function(e,r){r.success=((e,r,o="")=>e.send({data:r,message:o})),r.unAuthorized=((e,r)=>error(e,401,r)),r.error=((e,r)=>{error(e,500,r)}),r.vError=((e,r)=>error(e,400,r)),r.cError=((e,r)=>error(e,404,r)),r.nError=((e,r)=>error(e,404,r)),error=((e,r,o)=>e.status(r).send({message:o}))},function(e,r,o){const t=o(4),s=o(0),i=o(1);r.checkToken=((e,r,o)=>{let n=e.headers["x-access-token"]||e.headers.authorization;n&&n.startsWith("Bearer ")&&(n=n.slice(7,n.length)),n?t.verify(n,s.secret,(t,s)=>{t?i.unAuthorized(r,"Token is not valid."):(e.decoded=s,o())}):i.unAuthorized(r,"Authentication token is not supplied.")})},function(e,r){e.exports=require("mongoose")},function(e,r){e.exports=require("jsonwebtoken")},function(e,r,o){const t=o(3);var s=t.Schema;const i=t.Schema({number:String,userName:String,password:String,title:String,firstName:String,lastName:String,dob:String,age:Number,gender:String,mobileNo:String,emailId:String,ssnid:String,type:String,role:String,image:String,addressLine1:String,addressLine2:String,city:String,state:String,country:String,pincode:String,os:String,osVersion:String,isActive:Boolean,createdBy:{type:s.Types.ObjectId,default:null},updatedBy:{type:s.Types.ObjectId,default:null}},{timestamps:!0});e.exports=t.model("User",i)},function(e,r,o){const t=o(7),s=o(8);var i=o(9);const n=o(10),d=o(3);var a=t(),c=process.env.PORT||3001;a.use(s.urlencoded({extended:!0})),a.use(s.json()),a.use(i({credentials:!0,origin:!0})),d.Promise=global.Promise,d.connect(n.url,{useNewUrlParser:!0,useUnifiedTopology:!0}).then(()=>{console.log("Successfully connected to the database")}).catch(e=>{console.log("Could not connect to the database. Exiting now...",e),process.exit()}),a.use(t.static("assets")),a.use(t.static("web")),a.get("/",(e,r)=>{r.json({message:"api is alive."})}),o(11)(a),a.listen(c,()=>{console.log("API Server is listening on port "+c)})},function(e,r){e.exports=require("express")},function(e,r){e.exports=require("body-parser")},function(e,r){e.exports=require("cors")},function(e,r){e.exports={url:"mongodb+srv://naveen:nvnkmr%40123@cluster0-r86wa.mongodb.net/khadeem-demo?retryWrites=true&w=majority"}},function(e,r,o){"use strict";e.exports=(e=>{o(12)(e),o(14)(e),o(16)(e),o(19)(e)})},function(e,r,o){"use strict";const t=o(13),s=o(0).routePrefix+"/heartbeat";e.exports=(e=>{e.route(s).get(t.get)})},function(e,r,o){"use strict";const t=o(1);r.get=((e,r)=>t.success(r,null,"API is alive."))},function(e,r,o){"use strict";const t=o(2),s=o(15),i=o(0).routePrefix+"/account";e.exports=(e=>{e.post(i+"/login",s.login),e.post(i+"/changepassword/:id",t.checkToken,s.changePassword)})},function(e,r,o){"use strict";const t=o(4),s=o(0),i=o(5),n=o(1);r.login=((e,r)=>{if(!e.body.userName||!e.body.password)return n.vError(r,"Validation failed. Please fill all the required fields.");i.find({userName:e.body.userName,password:e.body.password,isActive:!0}).then(o=>{if(!o||o.length<1)return n.cError(r,"User not found.");(e.body.os||e.body.osVersion)&&i.findByIdAndUpdate(o[0]._id,{os:e.body.os||"",osVersion:e.body.osVersion||""},{new:!0}).then(e=>{}).catch(e=>{});let d=t.sign({username:e.body.userName},s.secret,{expiresIn:"24h"});return n.success(r,{token:d,user:o[0]})}).catch(e=>"ObjectId"===e.kind?n.nError(r,"User not found."):n.error(r,"Internal Server Error."))}),r.changePassword=((e,r)=>{if(!e.params.id||!e.body.password||!e.body.newPassword)return n.vError(r,"Validation failed. Please fill all the required fields.");let o=e.headers["user-id"]||"";i.findOneAndUpdate({_id:e.params.id,password:e.body.password},{password:e.body.newPassword||"",updatedBy:o},{new:!0}).then(e=>e&&e._id?n.success(r,!0):n.success(r,!1,"Please enter the valid password.")).catch(o=>"ObjectId"===o.kind?n.nError(r,"Record not found with id "+e.params.id):n.error(r,"Internal server error. Error updating record with id "+e.params.id))})},function(e,r,o){"use strict";const t=o(2),s=o(17),i=o(0).routePrefix+"/user";e.exports=(e=>{e.post(i,t.checkToken,s.create),e.get(i+"s",t.checkToken,s.findAll),e.get(i+"/:id",t.checkToken,s.findOne),e.put(i+"/:id",t.checkToken,s.update),e.delete(i+"/:id",t.checkToken,s.delete)})},function(e,r,o){"use strict";const t=o(5),s=o(1);o(18);r.create=((e,r)=>{let o=e.headers["user-id"]||"";if(!(o&&e.body.userName&&e.body.password&&e.body.firstName))return s.vError(r,"Validation failed. Please fill all the required fields.");t.findOne({$and:[{$or:[{userName:e.body.userName}],isActive:!0}]},{_id:1}).then(i=>{if(i&&i._id)return s.cError(r,"User with same mobile number already exists. So please try with different mobile number.");new t({number:e.body.number||"",userName:e.body.userName||"",password:e.body.password||"",title:e.body.title||"",firstName:e.body.firstName||"",lastName:e.body.lastName||"",dob:e.body.dob||"",age:e.body.age||0,gender:e.body.gender||"",mobileNo:e.body.mobileNo||"",emailId:e.body.emailId||"",ssnid:e.body.ssnid||"",type:e.body.type||"",role:e.body.role||"",image:e.body.image||"",addressLine1:e.body.addressLine1||"",addressLine2:e.body.addressLine2||"",city:e.body.city||"",state:e.body.state||"",country:e.body.country||"",pincode:e.body.pincode||"",os:"",osVersion:"",isActive:!0,createdBy:o}).save().then(e=>e&&e._id?s.success(r,e._id):s.cError(r,"Some error occurred while creating a record.")).catch(e=>s.error(r,e.message||"Some error occurred while creating a record."))}).catch(e=>s.error(r,e.message||"Some error occurred while creating a record."))}),r.findAll=((e,r)=>{t.find({isActive:!0}).then(e=>s.success(r,e)).catch(e=>s.error(r,e.message||"Some error occurred while retrieving data."))}),r.findOne=((e,r)=>{t.findById(e.params.id).then(o=>o&&o._id?s.success(r,o):s.cError(r,"Record not found with id "+e.params.id)).catch(o=>"ObjectId"===o.kind?s.nError(r,"Record not found with id "+e.params.id):s.error(r,"Error retrieving record with id "+e.params.id))}),r.update=((e,r)=>{let o=e.headers["user-id"]||"";if(!(o&&e.body.userName&&e.body.password&&e.body.firstName))return s.vError(r,"Validation failed. Please fill all the required fields.");let i={number:e.body.number||"",userName:e.body.userName||"",password:e.body.password||"",title:e.body.title||"",firstName:e.body.firstName||"",lastName:e.body.lastName||"",dob:e.body.dob||"",age:e.body.age||0,gender:e.body.gender||"",mobileNo:e.body.mobileNo||"",emailId:e.body.emailId||"",ssnid:e.body.ssnid||"",type:e.body.type||"",role:e.body.role||"",image:e.body.image||"",addressLine1:e.body.addressLine1||"",addressLine2:e.body.addressLine2||"",city:e.body.city||"",state:e.body.state||"",country:e.body.country||"",pincode:e.body.pincode||"",updatedBy:o};t.findOne({userName:e.body.userName,isActive:!0},{_id:1}).then(o=>{if(o&&o._id&&o._id!=e.params.id)return s.cError(r,"User with same user name already exists. So please try with different user name.");t.findByIdAndUpdate(e.params.id,i,{new:!0}).then(o=>o&&o._id?s.success(r,o._id):s.cError(r,"Error updating record with id "+e.params.id)).catch(o=>"ObjectId"===o.kind?s.nError(r,"Record not found with id "+e.params.id):s.error(r,"Internal server error. Error updating record with id "+e.params.id))}).catch(o=>s.error(r,"Internal server error. Error updating record with id "+e.params.id))}),r.delete=((e,r)=>{let o=e.headers["user-id"]||"";if(!o)return s.vError(r,"Validation failed. Please fill all the required fields.");t.findByIdAndUpdate(e.params.id,{isActive:!1,updatedBy:o||null}).then(o=>o&&o._id?s.success(r,!0,"Record deleted successfully."):s.cError(r,"Could not delete record with id "+e.params.id)).catch(o=>"ObjectId"===o.kind||"NotFound"===o.name?s.nError(r,"Record not found with id "+e.params.id):s.error(r,"Internal server error. Could not delete record with id "+e.params.id))})},function(e,r){r.clone=(e=>JSON.parse(JSON.stringify(e)))},function(e,r,o){"use strict";const t=o(2);var s=o(20);const i=o(0).routePrefix+"/upload",n=s.diskStorage({destination(e,r,o){o(null,"./assets/file")},filename(e,r,o){o(null,`${r.originalname}`)}}),d=s({storage:n});e.exports=(e=>{e.post(i,t.checkToken,d.single("file"),(e,r,o)=>r.send({data:!0,message:""}))})},function(e,r){e.exports=require("multer")}]);